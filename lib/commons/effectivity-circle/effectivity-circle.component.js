"use strict";var __decorate=this&&this.__decorate||function(e,t,r,n){var o,a=arguments.length,i=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(i=(a<3?o(i):a>3?o(t,r,i):o(t,r))||i);return a>3&&i&&Object.defineProperty(t,r,i),i},__metadata=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},core_1=require("@angular/core"),game_status_service_1=require("../../services/game-status.service"),Observable_1=require("rxjs/Observable"),game_control_1=require("../../services/game-control"),EffectivityCircle=function(){function e(e,t){this.gameStatus=e,this.gameControl=t,this.wholeGame=!1,this.isGameOver=!1,this.effectivity=0}return e.prototype.ngOnInit=function(){this.replay()},e.prototype.replay=function(){var e=this;this.runEffectivity().subscribe(function(t){e.effectivity=t})},e.prototype.runEffectivity=function(){var e=this;return Observable_1.Observable.create(function(t){var r=0,n=e.calculateEffectivity(e.wholeGame),o=setInterval(function(){return r>=n?(t.next(parseInt(""+n,10)),t.complete(),clearInterval(o)):void t.next(r++)},50)})},e.prototype.calculateEffectivity=function(e){console.log("wholeGame",e,this.gameControl.getGameInstance().levels.length,this.gameStatus.level+1);var t=e?this.gameControl.getGameInstance().levels.length:this.gameStatus.level,r=0,n=0;if(this.isGameOver&&!e&&t++,0!=this.gameStatus.score){for(var o=0;o<t;o++){var a=this.gameControl.getGameInstance().levels[o],i=a.scoreConfig.baseScore+a.scoreConfig.extras[0].extraScore;n+=i*a.gameProblems.length}r=100*this.gameStatus.score/n}return r},__decorate([core_1.Input(),__metadata("design:type",Boolean)],e.prototype,"wholeGame",void 0),__decorate([core_1.Input(),__metadata("design:type",Boolean)],e.prototype,"isGameOver",void 0),e=__decorate([core_1.Component({selector:"effectivity-circle",template:'\n      <button class="progress-button" md-mini-fab color="accent">\n        <p><strong>{{effectivity}}</strong></p>\n        <md-progress-circle  class="inner-button-progress" mode="determinate" [value]="effectivity" ></md-progress-circle> \n      </button>\n\n',styles:["\n        md-progress-circle.inner-button-progress{\n          position: inherit;\n          z-index: 10;\n          transform: translateY(-70%) translateX(-28%);\n        }\n        \n        button.progress-button{\n          margin: 45px\n        }\n        button.progress-button p{\n          margin: 2px\n        }\n      "]}),__metadata("design:paramtypes",[game_status_service_1.GameStatusService,game_control_1.GameControl])],e)}();exports.EffectivityCircle=EffectivityCircle;